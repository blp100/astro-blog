---
import { contentfulClient } from "../../../lib/contentful";
import type { BlogPost, BlogCategory, HeroImage } from "../../../lib/contentful";
import { getLangFromUrl, useTranslations } from "../../../i18n/utils";
import BlogPostList from "../../../components/BlogPostList.astro";
import IndexLayout from "../../../layouts/IndexLayout.astro";
import BaseHead from "../../../components/BaseHead.astro";
import Body from "../../../components/Body.astro";
import Header from "../../../components/Header.astro";
import Article from "../../../components/Article.astro";
import Footer from "../../../components/Footer.astro";
import { SITE_DESCRIPTION, SITE_TITLE } from "../../../consts";

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

const entries = await contentfulClient.getEntries<BlogCategory>({
  content_type: "astroCategories",
  locale: t("contentful.locale"),
  order: ["-sys.createdAt"],
});

const posts = entries.items.map((item) => {
  const { updatedAt } = item.sys;
  const { title, slug } = item.fields;

  return {
    title,
    slug,
  };
});
---

<!DOCTYPE html>
<html lang={lang}>
  <head>
    <BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
  </head>
  <Body>
    <Header title={SITE_TITLE} />
    <main class="pt-16">
      <Article>
        <section>
          <ul>
            {
              posts.map((post) => {
                const { title } = post;
                return (
                  <li>
                      <a href={`categories/${title}`}>{title}</a>
                  </li>
                );
              })
            }
          </ul>
        </section>
      </Article>
    </main>
    <Footer />
  </Body>
</html>
