---
import Post from "../../layouts/Post.astro";
import { contentfulClient } from "../../lib/contentful";
import type { BlogPost, HeroImage } from "../../lib/contentful";
import { Markdown } from "@astropub/md";

export async function getStaticPaths() {
  const { items } = await contentfulClient.getEntries<BlogPost>({
    content_type: "astroBlog",
  });

  const pages = items.map((item) => {
    const { title, date, content, description, heroImage, slug } = item.fields;
    return {
      params: { slug },
      props: {
        title,
        content: content.toString(),
        pubDate: new Date(date),
        description,
        heroImage: (heroImage as HeroImage).fields.file.url,
      },
    };
  });
  return pages;
}

const { content, ...data } = Astro.props;
---
<Post {...data}>
  <Markdown.Inline of={content} />
</Post>
