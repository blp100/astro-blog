---
import Post from "../../layouts/Post.astro";
import { contentfulClient } from "../../lib/contentful";
import type { BlogPost, HeroImage } from "../../lib/contentful";
import { Markdown } from "@astropub/md";

let post;
const { slug } = Astro.params;
try {
  const data = await contentfulClient.getEntries<BlogPost>({
    content_type: "astroBlog",
    "fields.slug": slug,
  });
  const { title, date, content,description, heroImage } = data.items[0].fields;
  console.log(data.items[0].fields.content);
  post = {
    title,
    pubDate: new Date(date),
    content,
    description,
    heroImage: (heroImage as HeroImage).fields.file.url,
  };
} catch (error) {
  return Astro.redirect("/404");
}
---

<Post {...post}>
  <Markdown.Inline of={post?.content.toString()} />
</Post>